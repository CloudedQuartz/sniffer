{
    "version": "1.3.231.1",
    "description": "SDK for new generation graphics and compute API",
    "homepage": "https://www.vulkan.org",
    "license": {
        "identifier": "MIT,...",
        "url": "https://vulkan.lunarg.com/license/#/license"
    },
    "notes": [
        "Make sure you have the vulkan driver installed.",
        "Variety of drivers of different graphic card vendors could be found at the bottom of 'https://www.khronos.org/vulkan/'"
    ],
    "url": "https://sdk.lunarg.com/sdk/download/1.3.231.1/windows/VulkanSDK-1.3.231.1-Installer.exe#/dl.7z",
    "hash": "ffdf442893761a453499d612d86534a02573c3d2b2442b40311b69a4b2518bf2",
    "pre_install": "Remove-Item \"$dir\\`$*\", \"$dir\\Uninstal*\" -Recurse",

    "architecture": {
        "64bit": {
            "env_add_path": [
                "Bin"
            ],
            "post_install": [
                "if ($global) { # check if global install",
                "$vk_explicit_reg_path = 'HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers'",
                "if (!$(Test-Path $vk_explicit_reg_path)) { $null = New-Item -Path $vk_explicit_reg_path -Force }",
                "$vulkan_bin = \"$dir\\Bin\"",
                "$vk_layers = Get-ChildItem -Path $vulkan_bin -Filter '*.json'",
                "$installed_layers = Get-Item -Path $vk_explicit_reg_path | Select-Object -ExpandProperty Property",
                "foreach ($vk_layer in $vk_layers) {",
                "    if ($vk_layer -notin $installed_layers) {",
                "        $null = New-ItemProperty -Path $vk_explicit_reg_path -Name $vk_layer -PropertyType DWord -Value 0",
                "    }",
                "} } else {",
                "     Write-Host 'WARNING: VK layers provided by Khronos is not registered. They are registered only for global installation.' -f Yellow",
                "     Write-Host 'If you need them, reinstall $app globally. Or manually add them to HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers with regedit.' -f Yellow",
                "}"
            ],
            "pre_uninstall": [
                "if ($global) { # check if global install",
                "$vk_explicit_reg_path = 'HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers'",
                "$vulkan_bin = \"$globaldir\\apps\\$app\\current\\Bin\"",
                "$vk_layers = Get-ChildItem -Path $vulkan_bin -Filter '*.json'",
                "$installed_layers = Get-Item -Path $vk_explicit_reg_path | Select-Object -ExpandProperty Property",
                "foreach ($vk_layer in $vk_layers) {",
                "    if ($vk_layer -in $installed_layers) {",
                "        $null = Remove-ItemProperty -Path $vk_explicit_reg_path -Name $vk_layer",
                "    }",
                "} }",
                "# this script runs only at global install"
            ]
        },
        "32bit": {
            "env_add_path": [
                "Bin32"
            ],
            "post_install": [
                "if ($global) { # check if global install",
                "$vk_explicit_reg_path = 'HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers'",
                "if (!$(Test-Path $vk_explicit_reg_path)) { $null = New-Item -Path $vk_explicit_reg_path -Force }",
                "$vulkan_bin = \"$dir\\Bin32\"",
                "$vk_layers = Get-ChildItem -Path $vulkan_bin -Filter '*.json'",
                "$installed_layers = Get-Item -Path $vk_explicit_reg_path | Select-Object -ExpandProperty Property",
                "foreach ($vk_layer in $vk_layers) {",
                "    if ($vk_layer -notin $installed_layers) {",
                "        $null = New-ItemProperty -Path $vk_explicit_reg_path -Name $vk_layer -PropertyType DWord -Value 0",
                "    }",
                "} } else {",
                "     Write-Host 'WARNING: VK layers provided by Khronos is not registered. They are registered only for global installation.' -f Yellow",
                "     Write-Host 'If you need them, reinstall $app globally. Or manually add them to HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers with regedit.' -f Yellow",
                "}"
            ],
            "pre_uninstall": [
                "if ($global) { # check if global install",
                "$vk_explicit_reg_path = 'HKLM:\\SOFTWARE\\Khronos\\Vulkan\\ExplicitLayers'",
                "$vulkan_bin = \"$globaldir\\apps\\$app\\current\\Bin32\"",
                "$vk_layers = Get-ChildItem -Path $vulkan_bin -Filter '*.json'",
                "$installed_layers = Get-Item -Path $vk_explicit_reg_path | Select-Object -ExpandProperty Property",
                "foreach ($vk_layer in $vk_layers) {",
                "    if ($vk_layer -in $installed_layers) {",
                "        $null = Remove-ItemProperty -Path $vk_explicit_reg_path -Name $vk_layer",
                "    }",
                "} }",
                "# this script runs only at global install"
            ]
        }
    },
    "env_set": {
        "VULKAN_SDK": "$dir",
        "VK_SDK_PATH": "$dir"
    },
    "checkver": {
        "url": "https://vulkan.lunarg.com/sdk/latest/windows.json",
        "jsonpath": "$.windows"
    },
    "autoupdate": {
        "url": "https://sdk.lunarg.com/sdk/download/$version/windows/VulkanSDK-$version-Installer.exe#/dl.7z",
        "hash": {
            "url": "https://vulkan.lunarg.com/sdk/files.json",
            "jsonpath": "$.windows['$version'].files[?(@.file_name == '$basename')].sha"
        }
    }
}
